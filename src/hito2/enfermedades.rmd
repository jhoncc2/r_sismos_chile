---
title: "enfermedades"
author: "Jhonny Cerezo, Pablo Elguer, Cristi치n Llull, Rodrigo Llull"
date: "Octubre de 2019"
output:
  html_document:
    toc: true
    toc_float: true
    theme: yeti # o readable o default
  pdf_document:
    latex_engine: xelatex
    toc: yes
# Configuraciones del documento pdf
fontsize: 12pt
mainfont: Charter
sansfont: Arial
monofont: Liberation Mono
---

# Estudio



# Funci칩n para agregar las fechas a los dataframes
```{r agregarFechas}
agregarFechas <- function(dataframe) {
  fechas <- as.Date(dataframe$Time, "%Y-%m-%d")
  fechas <- data.frame(Year=as.numeric(format(fechas, format="%Y")),
                       Month=as.numeric(format(fechas, format="%m")),
                       Day=as.numeric(format(fechas, format="%d")))
  fecha_num <- data.frame(num_date=fechas$Year +
                            (fechas$Month-1)/12 +
                            (fechas$Day-1)/24/12)
  fechas <- cbind(fechas, fecha_num)
  cbind(dataframe, fechas)
}
```

```{r escribirSismos}
#sismos <- read.delim("http://users.dcc.uchile.cl/~rllull/CC5206/sismos.csv", header = TRUE, sep = ",", quote = "\"", dec = ".", fill = TRUE, comment.char = "#")
all <- read.delim("Datasets sismol칩gicos/all.csv", header = TRUE, sep = "|", quote = "\"", dec = ".", fill= TRUE, comment.char = "#")
sismos <- agregarFechas(all)
write.csv(sismos, "sismos.csv", row.names=FALSE)
```

```{r cargarSismos}
sismos <- read.delim("http://users.dcc.uchile.cl/~rllull/CC5206/sismos.csv",
                     header = TRUE, sep = ",", quote = "\"", dec = ".", fill = TRUE, comment.char = "#")
```

```{r}
plot(sismos[sismos$Magnitude >= 6, ]$num_date, sismos[sismos$Magnitude >= 6, ]$Latitude,
     pch="*", main="Sismos desde 1960\nde magnitud mayor o igual a 6 Mw",
     xlab="Fecha", ylab="Latitud")
```

```{r cargarEtas}
# Carga de las ETAs
etas <- read.delim("http://users.dcc.uchile.cl/~rllull/CC5206/etas2011_2017.csv",
                   header = TRUE, sep = ",", quote = "\"", dec = ".", fill = TRUE, comment.char = "#")
agregarFechasEtas <- function(dataframe) {
  fechas <- as.Date(dataframe$Fecha.de.Ingesti칩n, "%d-%m-%Y")
  fechas <- data.frame(Year=as.numeric(format(fechas, format="%Y")),
                       Month=as.numeric(format(fechas, format="%m")),
                       Day=as.numeric(format(fechas, format="%d")))
  fecha_num <- data.frame(num_date=fechas$Year +
                            (fechas$Month-1)/12 +
                            (fechas$Day-1)/24/12)
  fechas <- cbind(fechas, fecha_num)
  cbind(dataframe, fechas)
}
etas <- agregarFechasEtas(etas)
```

```{r}
# Join de sismos con etas, analizaremos solo los mayores o iguales a 6 y entre el 2011 y 2017
# Con esto se extraen las enfermedades que fueron reportadas en un mes en que hubo sismos mayores o iguales a 6 Mw
sismosMayoresA6 <- sismos[sismos$Magnitude >= 6 & sismos$Year >= 2011 & sismos$Year <= 2017, ]
sismos_y_etas <- merge(sismosMayoresA6, etas, by=c("Year", "Month"))
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
